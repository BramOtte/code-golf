s=8,M=Math,P=M.PI/2,r=e=>0|M.random()*s,c=60,K={d:0,s:1,a:2,w:3},f="fillStyle",I=[],i=x=y=X=Y=0,F=[],T=[],t=h=3,d=document,H=d.createElement("canvas"),H.width=H.height=s*c,H.style.background="wheat",G=H.getContext("2d"),G.scale(c,c),p=(a,b)=>G.fillRect(a,b,1,1),onkeydown=a=>{L=I[0]??i,k=K[a.key],k+1&&k!=L&&k!=(L+2)%4&&I.push(k)},setInterval(e=>{for(d.body.append(H),G[f]="darkgreen",p(x,y),i=I.shift()??i,x=(x+M.cos(i*P)+s)%s,y=(y+M.sin(i*P)+s)%s,q=x+y*s,T.push([x,y]);T.length>t;)S=T.shift(),F[S[0]+S[1]*s]=0,G.clearRect(...S,1,1);if(1==F[q]&&(t=3),F[q]=1,x==X&y==Y){for(t++;F[X+Y*s];)Y=r(),X=r();t>h&&(h=t)}G[f]="green",p(x,y),G[f]="red",p(X,Y),d.title="snake "+t+"/"+h},200)
