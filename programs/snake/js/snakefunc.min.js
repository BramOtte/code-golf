"use strict";
function snake(W=16,H=9,S=30){let g=0,h=[],i=a=>{let b=h[0]??g;2>h.length&&(a==(b+1)%4||a==(b+3)%4)&&h.push(a)},j=document.createElement(`canvas`),k=j.getContext(`2d`),l=(a,b)=>k.fillRect(a,b,1,1),m=Math.PI/2,n=`fillStyle`,o=Array(W*H),p=[],q=3,r=3,s=0,t=0,u=0,v=(a,b,c)=>(a+Math.cos(b*m)+c)%c,w=()=>{k[n]=`red`,l(u%W,0|u/W),k[n]=`darkgreen`,l(s,t),g=h.shift()??g,s=v(s,g,W),t=v(t,g+3,H),k[n]=`green`,l(s,t);let a=s+t*W;if(p.push(a),o[a]&&(q=3),o[a]=1,a==u){for(q++;o[u];)u=0|Math.random()*o.length;q>r&&(r=q)}while(p.length>q){let a=p.shift();o[a]=0,k.clearRect(a%W,0|a/W,1,1)}};return j.width=W*S,j.height=H*S,j.style.background=`wheat`,k.scale(S,S),{canvas:j,step:w,input:i,score:()=>`${q}/${r}`}}
